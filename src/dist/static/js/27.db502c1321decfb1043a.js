webpackJsonp([27],{"kdf+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("RRo+"),s=i.n(n),a=i("s3ol"),o=i("bUp0"),l=[{key:!0,display_name:"显示"},{key:!1,display_name:"隐藏"}],r=[{key:!0,display_name:"可用"},{key:!1,display_name:"不可用"}],u={name:"menuList",components:{treeTable:a.a},data:function(){return{data:[],isShowOptions:l,statusOptions:r,menuOptions:[{key:0,display_name:"没有上级"}],textMap:{update:"Edit",create:"Create"},dialogFormVisible:!1,dialogAddFormVisible:!1,dialogStatus:"",enumid:0,permissionCollection:[],creatmenu:{menuId:0,menuName:void 0,vueFile:void 0,vueUrl:void 0,routerName:void 0,menuIcon:void 0,isShow:!0,status:!0,sort:void 0,pMenuId:0},rules:{menuName:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],vueFile:[{required:!0,message:"Vue文件不能为空",trigger:"blur"}],vueUrl:[{required:!0,message:"路径不能为空,父菜单填写noredirect",trigger:"blur"}],routerName:[{required:!0,message:"路由名称不能为空",trigger:"blur"}],sort:[{required:!0,message:"序号不能为空",trigger:"blur"},{validator:function(e,t,i){t&&s()(t)||i(new Error("请输入整数数字格式")),i()},trigger:"blur"}]},AddMenu:!1,EditMenu:!1,DeleteMenu:!1,EditPagePermission:!1}},filters:{statusFilter:function(e){return{1:"success",0:"danger"}[e]}},created:function(){var e=this;this.$store.dispatch("getPagePermission","menuList").then(function(t){e.AddMenu=t.AddMenu,e.EditMenu=t.EditMenu,e.DeleteMenu=t.DeleteMenu,e.EditPagePermission=t.EditPagePermission}),this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(o.g)().then(function(t){e.listLoading=!1,e.data=t.data.data,e.menuOptions=[{key:0,display_name:"没有上级"}],t.data.data.forEach(function(t){t.pMenuId||e.menuOptions.push({key:t.menuId,display_name:t.menuName})})})},modifyPermission:function(e){var t=this;this.enumid=e.menuId,this.permissionCollection=[],e.permission&&0!=e.permission.length?e.permission.forEach(function(e){t.permissionCollection.push({permissionCode:e.permissionCode,permissionName:e.permissionName})}):this.permissionCollection.push({permissionCode:"",permissionName:""}),this.dialogFormVisible=!0},AddSumbit:function(e){var t=this;this.$refs.creatMenuForm.validate(function(i){i&&t.ReqAddEditSumbit(e,!1)})},ReqAddEditSumbit:function(e,t){var i=this;Object(o.c)(this.creatmenu,e).then(function(e){e.data;i.dialogAddFormVisible=!1,i.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3}),t||i.getList()})},handleCreate:function(){var e=this;this.dialogStatus="create",this.dialogAddFormVisible=!0,this.creatmenu={menuId:0,menuName:void 0,vueFile:void 0,vueUrl:void 0,routerName:void 0,menuIcon:void 0,isShow:!0,status:!0,sort:void 0,pMenuId:0},this.$nextTick(function(){e.$refs.creatMenuForm.clearValidate()})},handleUpdate:function(e){var t=this;this.dialogStatus="update",this.creatmenu={menuId:e.menuId,menuName:e.menuName,vueFile:e.vueFile,vueUrl:e.vueUrl,routerName:e.routerName,menuIcon:e.menuIcon,isShow:e.isShow,status:e.status,sort:e.sort,pMenuId:e.pMenuId},this.dialogAddFormVisible=!0,this.$nextTick(function(){t.$refs.creatMenuForm.clearValidate()})},handleUpdateSwith:function(e){this.EditMenu&&(this.creatmenu={menuId:e.menuId,menuName:e.menuName,vueFile:e.vueFile,vueUrl:e.vueUrl,routerName:e.routerName,menuIcon:e.menuIcon,isShow:e.isShow,status:e.status,sort:e.sort,pMenuId:e.pMenuId},this.ReqAddEditSumbit("update",!0))},handleDel:function(e){var t=this;this.$confirm("此操作将永久删除【"+e.menuName+"】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.d)(e.menuId).then(function(){t.$message({type:"success",message:"删除成功!"}),t.getList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},ModifyPermissionSumbit:function(){var e=this;Object(o.a)(this.enumid,this.permissionCollection).then(function(){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3}),e.getList()})},padd:function(){this.permissionCollection.push({permissionCode:"",permissionName:""})},pdel:function(e){1==this.permissionCollection.length?this.permissionCollection=[{permissionCode:"",permissionName:""}]:this.permissionCollection.splice(e,1)}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[e.AddMenu?i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add")))]):e._e()],1),e._v(" "),i("tree-table",{attrs:{data:e.data,border:""}},[i("el-table-column",{attrs:{label:"菜单名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.menuName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Vue文件"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.vueFile))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.vueUrl))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"路由名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.routerName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"图标",width:"50"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("span",[i("svg-icon",{attrs:{"icon-class":e.row.menuIcon}})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"权限值"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.permission,function(t){return i("el-tag",{key:t.permissionName+"_"+t.permissionCode,staticStyle:{"margin-left":"1px"}},[e._v(e._s(t.permissionName))])})}}])}),e._v(" "),i("el-table-column",{attrs:{"class-name":"status-col",label:"是否隐藏",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{on:{change:function(i){e.handleUpdateSwith(t.row)}},model:{value:t.row.isShow,callback:function(i){e.$set(t.row,"isShow",i)},expression:"scope.row.isShow"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{"class-name":"status-col",label:e.$t("table.status"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{on:{change:function(i){e.handleUpdateSwith(t.row)}},model:{value:t.row.status,callback:function(i){e.$set(t.row,"status",i)},expression:"scope.row.status"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"排序",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.sort))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.EditPagePermission&&"noredirect"!=t.row.vueUrl?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.modifyPermission(t.row)}}},[e._v(" 编辑权限 ")]):e._e(),e._v(" "),e.EditMenu?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v(e._s(e.$t("table.edit")))]):e._e(),e._v(" "),e.DeleteMenu?i("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(i){e.handleDel(t.row)}}}):e._e()]}}])})],1),e._v(" "),i("el-dialog",{attrs:{fullscreen:this.isMobile,title:e.textMap[e.dialogStatus],visible:e.dialogAddFormVisible},on:{"update:visible":function(t){e.dialogAddFormVisible=t}}},[i("el-form",{ref:"creatMenuForm",staticStyle:{"margin-left":"50px"},attrs:{rules:e.rules,model:e.creatmenu,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.menuName,callback:function(t){e.$set(e.creatmenu,"menuName",t)},expression:"creatmenu.menuName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Vue文件",prop:"vueFile"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.vueFile,callback:function(t){e.$set(e.creatmenu,"vueFile",t)},expression:"creatmenu.vueFile"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"路径",prop:"vueUrl"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.vueUrl,callback:function(t){e.$set(e.creatmenu,"vueUrl",t)},expression:"creatmenu.vueUrl"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"路由名称",prop:"routerName"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.routerName,callback:function(t){e.$set(e.creatmenu,"routerName",t)},expression:"creatmenu.routerName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"图标",prop:"menuIcon"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.menuIcon,callback:function(t){e.$set(e.creatmenu,"menuIcon",t)},expression:"creatmenu.menuIcon"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"上级菜单",prop:"pMenuId"}},[i("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},model:{value:e.creatmenu.pMenuId,callback:function(t){e.$set(e.creatmenu,"pMenuId",t)},expression:"creatmenu.pMenuId"}},e._l(e.menuOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"是否显示",prop:"isShow"}},[i("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},model:{value:e.creatmenu.isShow,callback:function(t){e.$set(e.creatmenu,"isShow",t)},expression:"creatmenu.isShow"}},e._l(e.isShowOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"是否可用",prop:"status"}},[i("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},model:{value:e.creatmenu.status,callback:function(t){e.$set(e.creatmenu,"status",t)},expression:"creatmenu.status"}},e._l(e.statusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"排序",prop:"sort"}},[i("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.creatmenu.sort,callback:function(t){e.$set(e.creatmenu,"sort",e._n(t))},expression:"creatmenu.sort"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogAddFormVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.AddSumbit(e.dialogStatus)}}},[e._v(e._s(e.$t("table.confirm")))])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"编辑权限",width:"45%",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e._l(e.permissionCollection,function(t,n){return i("el-form",{key:n,staticClass:"demo-form-inline",staticStyle:{width:"auto"},attrs:{inline:!0,size:"mini"}},[i("el-form-item",{attrs:{label:"权限"}},[i("el-input",{model:{value:t.permissionName,callback:function(i){e.$set(t,"permissionName",i)},expression:"p.permissionName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"code"}},[i("el-input",{model:{value:t.permissionCode,callback:function(i){e.$set(t,"permissionCode",i)},expression:"p.permissionCode"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"danger"},on:{click:function(t){e.pdel(n)}}},[e._v("delete")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(i){e.padd(t)}}},[e._v("add")])],1)],1)}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.ModifyPermissionSumbit}},[e._v(e._s(e.$t("table.confirm")))])],1)],2)],1)},staticRenderFns:[]},m=i("VU/8")(u,c,!1,null,null,null);t.default=m.exports}});