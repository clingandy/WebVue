webpackJsonp([13],{"/t6J":function(e,t,s){"use strict";t.c=function(e){return Object(a.a)({url:"/system/GetAllSysRolePageList",method:"get",params:e})},t.a=function(e,t){var s="create"===t?"/System/AddSysRole":"/System/ModifySysRole";return Object(a.a)({url:s,method:"create"===t?"post":"put",data:e})},t.b=function(e){return Object(a.a)({url:"/system/DelSysRoleById",method:"delete",params:{id:e}})},t.d=function(){return Object(a.a)({url:"/system/getAllSysRoleList",method:"get"})};var a=s("vLgD")},"9Dio":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("o3g8"),r=s("/t6J"),i=s("5ybE"),l=[{key:!0,display_name:"正常"},{key:!1,display_name:"停用"}],n=[{key:1,display_name:"男"},{key:0,display_name:"女"}],o={name:"userList",directives:{waves:s("cAgV").a},data:function(){return{statusOptions:l,sexOptions:n,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogFormVisible:!1,tableKey:0,list:null,total:null,listLoading:!0,listQuery:{pageIndex:1,pageSize:10,userName:void 0,orgId:void 0},deptOptions:[],roleOptions:[],roles:[],createUser:{id:0,orgId:0,roleId:void 0,isLock:!1,status:!0,userName:void 0,userCode:void 0,userPwd:void 0},rules:{userCode:[{required:!0,message:"真实姓名不能为空",trigger:"blur"},{min:2,max:20,message:"长度在2到20个字符",trigger:"blur"}],userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:2,max:20,message:"长度在2到20个字符",trigger:"blur"}],orgId:[{required:!0,message:"所属部门不能为空",trigger:"change"}],roleId:[{required:!0,message:"所属角色不能为空",trigger:"change"}],userPwd:[{required:!0,message:"密码不能为空",trigger:"change"},{min:6,max:15,message:"长度在6到15个字符",trigger:"blur"}]},AddUser:!1,EditUser:!1,DeleteUser:!1}},watch:{},created:function(){var e=this;this.$store.dispatch("getPagePermission","userList").then(function(t){e.AddUser=t.AddUser,e.EditUser=t.EditUser,e.DeleteUser=t.DeleteUser}),this.getDeptList(),this.getRoleList(),this.getList()},filters:{statusFilter:function(e){return{1:"success",0:"danger"}[e]}},methods:{deptConvert:function(e){var t=this.deptOptions.find(function(t){return t.key==e});if(t)return t.display_name},roleConvert:function(e){var t=this.roles.find(function(t){return t.roleId==e});if(t)return t.roleName},getDeptList:function(){var e=this;Object(i.c)().then(function(t){t.data.data.forEach(function(t){e.deptOptions.push({key:t.orgId,display_name:t.orgName})})})},getRoleList:function(){var e=this;Object(r.d)().then(function(t){e.roles=t.data.data})},selectRoleByOrgId:function(e){var t=this;this.roleOptions=[],this.roles.forEach(function(s){s.orgId==e&&t.roleOptions.push({key:s.roleId,display_name:s.roleName})}),this.createUser.roleId=this.roleOptions[0]?this.roleOptions[0].key:void 0},getList:function(){var e=this;this.listLoading=!0,Object(a.c)(this.listQuery).then(function(t){e.list=t.data.data,e.total=t.data.total,e.listLoading=!1})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageIndex=e,this.getList()},handleFilter:function(){this.listQuery.pageIndex=1,this.getList()},handleCreate:function(){var e=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.createUser={id:0,orgId:this.deptOptions[0].key,roleId:void 0,isLock:!1,status:!0,userName:void 0,userCode:void 0,userPwd:void 0},this.$nextTick(function(){e.$refs.creatUserForm.clearValidate()})},handleUpdate:function(e){var t=this;this.dialogStatus="update",this.createUser={userId:e.userId,orgId:e.orgId,roleId:e.roleId,isLock:e.isLock,status:e.status,userName:e.userName,userCode:e.userCode,userPwd:"********"},this.selectRoleByOrgId(e.orgId),this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.creatUserForm.clearValidate()})},handleUpdateSwith:function(e){this.EditUser&&(this.createUser={userId:e.userId,roleId:e.roleId,orgId:e.orgId,isLock:e.isLock,status:e.status,userName:e.userName,userCode:e.userCode,userPwd:"********"},this.reqAddEditSumbit("update",!0))},addSumbit:function(e){var t=this;this.$refs.creatUserForm.validate(function(s){s&&t.reqAddEditSumbit(e,!1)})},reqAddEditSumbit:function(e,t){var s=this;Object(a.a)(this.createUser,e).then(function(e){s.dialogFormVisible=!1,s.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3}),t||s.handleFilter()})},handleResetPwd:function(e){var t=this,s={userId:e.userId,pwd:"123456"};this.$confirm("此操作将重置【"+e.userName+"】用户密码, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.e)(s).then(function(e){t.$notify({title:"成功",message:"成功重置密码为：123456",type:"success",duration:2e3})})}).catch(function(){t.$message({type:"info",message:"已取消重置"})})},handleDel:function(e){var t=this;this.$confirm("此操作将永久删除【"+e.userName+"】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.b)(e.id).then(function(){t.$message({type:"success",message:"删除成功!"}),t.handleFilter()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container calendar-list-container"},[s("div",{staticClass:"filter-container"},[s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户登录名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.listQuery.userName,callback:function(t){e.$set(e.listQuery,"userName",t)},expression:"listQuery.userName"}}),e._v(" "),s("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{clearable:"",placeholder:"所属部门"},model:{value:e.listQuery.orgId,callback:function(t){e.$set(e.listQuery,"orgId",t)},expression:"listQuery.orgId"}},e._l(e.deptOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})})),e._v(" "),s("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(e._s(e.$t("table.search")))]),e._v(" "),e.AddUser?s("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add")))]):e._e()],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[s("el-table-column",{attrs:{align:"center",label:e.$t("table.id"),width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userId))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"用户登录名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"用户真实名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.userCode))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"所属部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.deptConvert(t.row.orgId)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.roleConvert(t.row.roleId)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"上次登录时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("formatDate")(t.row.modifyTime,"yyyy-MM-dd hh:mm")))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"错误次数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.errorCount))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"class-name":"status-col",label:"锁状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{on:{change:function(s){e.handleUpdateSwith(t.row)}},model:{value:t.row.isLock,callback:function(s){e.$set(t.row,"isLock",s)},expression:"scope.row.isLock"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{"class-name":"status-col",label:e.$t("table.status"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{on:{change:function(s){e.handleUpdateSwith(t.row)}},model:{value:t.row.status,callback:function(s){e.$set(t.row,"status",s)},expression:"scope.row.status"}})]}}])}),e._v(" "),s("el-table-column",{staticStyle:{width:"100%"},attrs:{align:"center",label:e.$t("table.actions"),"class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.EditUser?s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.handleUpdate(t.row)}}},[e._v(e._s(e.$t("table.edit")))]):e._e(),e._v(" "),e.EditUser?s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.handleResetPwd(t.row)}}},[e._v("重置")]):e._e()]}}])})],1),e._v(" "),s("div",{staticClass:"pagination-container"},[s("el-pagination",{attrs:{background:"","current-page":e.listQuery.pageIndex,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{fullscreen:this.isMobile,title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"creatUserForm",staticStyle:{"margin-left":"50px"},attrs:{rules:e.rules,model:e.createUser,"label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"登录名",prop:"userName"}},[s("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.createUser.userName,callback:function(t){e.$set(e.createUser,"userName",t)},expression:"createUser.userName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"真实名",prop:"userCode"}},[s("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.createUser.userCode,callback:function(t){e.$set(e.createUser,"userCode",t)},expression:"createUser.userCode"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"所属部门",prop:"orgId"}},[s("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},on:{change:e.selectRoleByOrgId},model:{value:e.createUser.orgId,callback:function(t){e.$set(e.createUser,"orgId",t)},expression:"createUser.orgId"}},e._l(e.deptOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"所属角色",prop:"roleId"}},[s("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},model:{value:e.createUser.roleId,callback:function(t){e.$set(e.createUser,"roleId",t)},expression:"createUser.roleId"}},e._l(e.roleOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),"create"==e.dialogStatus?s("el-form-item",{attrs:{label:"密码",prop:"userPwd"}},[s("el-input",{attrs:{autosize:"",placeholder:"Please input"},model:{value:e.createUser.userPwd,callback:function(t){e.$set(e.createUser,"userPwd",t)},expression:"createUser.userPwd"}})],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"状态",prop:"status"}},[s("el-select",{staticClass:"filter-item",attrs:{autosize:"",placeholder:"Please select"},model:{value:e.createUser.status,callback:function(t){e.$set(e.createUser,"status",t)},expression:"createUser.status"}},e._l(e.statusOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSumbit(e.dialogStatus)}}},[e._v(e._s(e.$t("table.confirm")))])],1)],1)],1)},staticRenderFns:[]},c=s("VU/8")(o,u,!1,null,null,null);t.default=c.exports}});